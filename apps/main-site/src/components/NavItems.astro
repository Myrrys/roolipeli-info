---
import type { User } from '@supabase/supabase-js';
import { useTranslations } from '../i18n/utils';

interface Props {
  lang?: 'fi' | 'en' | 'sv';
  user: User | null;
  profileDisplayName?: string | null;
}

const { lang = 'fi', user, profileDisplayName } = Astro.props;
const t = useTranslations(lang);
const pathname = Astro.url.pathname;
---

<ul class="site-header__nav">
  <li>
    <a
      href="/pelit"
      class={`site-header__link${pathname.startsWith('/pelit') ? ' site-header__link--active' : ''}`}
    >{t("nav.games.label")}</a>
  </li>
  <li>
    <a href="/tuotteet" class="site-header__link">{t("nav.products.label")}</a>
  </li>
  <li>
    <a href="/kustantajat" class="site-header__link">{t("nav.publishers.label")}</a>
  </li>
  <li>
    <a href="/tekijat" class="site-header__link">{t("nav.creators.label")}</a>
  </li>
</ul>
{
  user ? (
    <>
      {user.app_metadata?.role === 'admin' && (
        <a href="/admin" class="site-header__link">
          {t("nav.admin")}
        </a>
      )}
      <a href="/tili" class="site-header__link">
        {profileDisplayName || user.email || t("nav.account")}
      </a>
      <a href="/logout" class="site-header__btn">
        {t("nav.logout")}
      </a>
    </>
  ) : (
    <a href="/kirjaudu" class="site-header__btn site-header__btn--primary">
      {t("nav.login")}
    </a>
  )
}
